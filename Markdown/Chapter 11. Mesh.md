# Chapter 11. Mesh

## Assimp

실제 3D를 활용한 어플리케이션은 복잡하고 많은 수의 정점들로 이루어진 모델들로 구성될 수 있다. 하지만, 우리가 이전에 만들었던 컨테이너 오브젝트와는 다르게 복잡한 모델을 구성하기 위해서 직접 일일히 정점의 위치를 정할 수는 없다. 따라서 모델들을 불러오기 위해서는 일종의 Library 가 필요하다.

3D 아티스트들은 3D 모델링 툴을 이용해서 형태를 만들고, **uv-mapping** 을 이용해서 2D 이미지를 3D 형태에 알맞게 붙여 텍스쳐화 시킬 수 있다. 이런 툴들은 자동으로 정점과 노멀, 그 외의 정보들을 만들어 낸다. 아티스트들이야 별 상관 없을지도 모르겠지만 그래픽스 프로그래머를 꿈꾸는 자들에게는 안에 어떻게 돌아가는 지 조차 매우 중요하다.

아무튼 3D 툴에서 사용하는 특수 확장자 파일들을 OpenGL 이 인식할 수 있는 형태로 바꾸는 것은 모델을 Import 하는데 있어서 매우 중요하고, 우리가 해야하는 작업이다. 하지만 엄청 많은 확장자의 파일들이 존재하기 때문에 파일 하나하나마다 일일히 들여올 수 있도록 직접 코딩하는 것은 힘들고 번거롭고 쓸데도 없다.

### A model loading library

무수한 3D 모델 확장자 파일들을 쉽게 OpenGL 이 그나마 잘 인식할 수 있는 형태로 불러올 수 있는 라이브러리가 [Assimp](http://assimp.sourceforge.net/) 이다. 물론 Assimp 가 불러오면 Assimp 자체의 데이터 형태로 바꿔서 결과물을 내놓기 때문에 이를 다시 OpenGL 이 인식할 수 있도록 바꿔야 한다.

Assimp 을 통해서 전체 모델을 불러올 때 모델은 **Scene** 오브젝트에 불러오게 된다. Scene 오브젝트는 불러온 Model / Scene 의 모든 데이터를 담고 있다. 그리고 Assimp 는 **Node** 컨테이너를 가지고 있는데, Node 는 Scene 오브젝트에 저장된 데이터의 순번을 저장하고 있다. 그리고 각 Node 마다 자식 Node 을 가질 수 있다.

![img](https://learnopengl.com/img/model_loading/assimp_structure.png)

* Scene / model 의 모든 데이터는 Scene 오브젝트에 들어가 있다.
* Root Node 는 Children node 을 저장하고 있으며 Scene Object 의 `mMeshes` 배열의 **Mesh** 데이터를 가리키는 여러 개의 인덱스들을 담고 있다.
* **Mesh** 오브젝트는 *렌더링* 에 필요한 관련된 모든 정보들을 담고 있다. 정점 위치, 노멀 벡터, 텍스쳐 좌표, Face 나 오브젝트의 Material (재질) 정보를 가진다.
* Mesh 오브젝트는 몇 몇개의 **Face** 을 가질 수 있다. Face 는 오브젝트의 렌더링 프리미티브를 일컫어 말한다. Face 는 프리미티브를 형성하는 정점들의 순서를 담고 있다. 정점 데이터와 인덱스 데이터가 서로 따로 분리되어 있기 때문에 `EBO` 와 같은 인덱스 버퍼를 이용해 렌더링을 할 수 있도록 도와준다.
* Mesh 오브젝트는 **Material** 정보를 가진다. Color 및 Texture map 의 정보를 가질 수 있다.

때문에 Assimp 로 먼저 해야할 작업은, Scene Object 에 모델을 로딩하고, 각 노드를 탐색해서 Mesh object 을 불러온 뒤에 각 Mesh 오브젝트의 정점 데이터를 불러올 수 있도록 처리하는 것이다. 그 다음에 Face 와 material 정보를 불러와 최종 **Model** 데이터를 만드는 것이다.

>Mesh
>
>모델링 툴을 이용해서 모델링을 할 때, 아티스트들은 한 개의 덩어리 전체 모델을 만들지 않는다. 대신에 여러 형태의 서브 모델을 만들어서 그것을 붙이거나 하는 등으로 전체 모델을 만든다.
>
>전체 모델에서 각 각의 Sub-model 을 일컫어 **Mesh** 라고 부른다.

## Mesh

